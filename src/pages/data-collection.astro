---
import { Image } from 'astro:assets';
import logo from '../../public/logo.png';
---

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/logo.png" />
	<title>GearScout</title>
</head>
<body>
	<div class="header">
		<div class="logo">
			<Image src={logo} alt="2338 logo" height={100} width={100} loading="eager" fetchpriority="high"/>
		</div>
		<div class="analytics">
			<a href="https://data.gearitforward.com/" class="analytics-button">ANALYTICS</a>
		</div>
	</div>

	<main class="page data-collection-page">
		<form class="data-collection-form" id="data-collection-form">
			<div class="content-wrapper">

				<div class="form-field">
					<input 
						id="match-number" 
						name="matchNumber" 
						type="number" 
						min="0" 
						max="999"
						autocomplete="off"
					/>
					<label for="match-number">Match Number</label>
				</div>

				<div id="team-number-container">
					<div class="team-number-loader" id="schedule-loader" style="display: none;">
						<div class="textbox-placeholder">Team Number</div>
						<div class="spin-loader"></div>
					</div>

					<div class="form-field" id="team-number-dropdown-container" style="display: none;">
						<select id="team-number-dropdown" name="teamNumberDropdown">
							<option value="">Select Team</option>
						</select>
						<label for="team-number-dropdown">Team Number</label>
					</div>

					<div class="form-field" id="team-number-manual-container">
						<input 
							id="team-number" 
							name="teamNumber" 
							type="number"
							autocomplete="off"
						/>
						<label for="team-number">Team Number</label>
					</div>
				</div>

				<div class="alliance-section" id="alliance-section">
					<div class="toggle-button-group">
						<button type="button" class="alliance-toggle red" data-value="red">
							RED ALLIANCE
						</button>
						<button type="button" class="alliance-toggle blue" data-value="blue">
							BLUE ALLIANCE
						</button>
					</div>
				</div>

				<h2 class="section-title">Auto</h2>

				<div class="trench-container">
					<div class="trench-buttons">
						<button type="button" class="trench-button left-trench">
							RED TRENCH
						</button>
						<span class="counter" id="left-counter">0</span>
						<span class="counter" id="right-counter">0</span>
						<button type="button" class="trench-button right-trench">
							BLUE TRENCH
						</button>
					</div>
					<div class="trench-decrements">
						<button type="button" class="trench-decrement left-decrement">
							−
						</button>
						<button type="button" class="trench-decrement right-decrement">
							−
						</button>
					</div>
				</div>

				<div class="trench-container">
					<div class="trench-buttons">
						<button type="button" class="trench-button left-bump">
							RED BUMP
						</button>
						<span class="counter" id="left-bump-counter">0</span>
						<span class="counter" id="right-bump-counter">0</span>
						<button type="button" class="trench-button right-bump">
							BLUE BUMP
						</button>
					</div>
					<div class="trench-decrements">
						<button type="button" class="trench-decrement left-bump-decrement">
							−
						</button>
						<button type="button" class="trench-decrement right-bump-decrement">
							−
						</button>
					</div>
				</div>

				<h3 class="objective-label">Accuracy</h3>
				<div class="accuracy-button-group">
					<button type="button" class="accuracy-button" data-value="0">0%</button>
					<button type="button" class="accuracy-button" data-value="25">25%</button>
					<button type="button" class="accuracy-button" data-value="50">50%</button>
					<button type="button" class="accuracy-button" data-value="75">75%</button>
					<button type="button" class="accuracy-button" data-value="95">95%</button>
					<button type="button" class="accuracy-button" data-value="100">100%</button>
				</div>
				<h3 class="objective-label">Climb</h3>
				<div class="toggle-button-group">
					<button type="button" class="toggle-button selected" data-value="no">
						No
					</button>
					<button type="button" class="toggle-button" data-value="yes">
						Yes
					</button>
				</div>

				<h2 class="section-title">Teleop</h2>

				<div id="previous-cycle-section" class="previous-cycle-section" style="display: none;">
					<h3 class="objective-label">Previous Cycle</h3>
					
					<h4 class="sub-label">Accuracy</h4>
					<div class="accuracy-button-group">
						<button type="button" class="accuracy-button-previous" data-value="0">0%</button>
						<button type="button" class="accuracy-button-previous" data-value="25">25%</button>
						<button type="button" class="accuracy-button-previous" data-value="50">50%</button>
						<button type="button" class="accuracy-button-previous" data-value="75">75%</button>
						<button type="button" class="accuracy-button-previous" data-value="95">95%</button>
						<button type="button" class="accuracy-button-previous" data-value="100">100%</button>
					</div>
					
					<h4 class="sub-label estimate-size-label">Estimated Size</h4>
					<div class="form-field estimate-size-field">
						<select id="estimate-size-previous" name="estimateSizePrevious">
							<option value="">Select Range</option>
							<option value="1-10">1-10</option>
							<option value="11-25">11-25</option>
							<option value="26+">26+</option>
						</select>
						<label for="estimate-size-previous">Estimate Size</label>
					</div>
				</div>

				<h3 class="objective-label" id="current-cycle-label">Current Cycle</h3>
				
				<h4 class="sub-label">Accuracy</h4>
				<div class="accuracy-button-group">
					<button type="button" class="accuracy-button-teleop" data-value="0">0%</button>
					<button type="button" class="accuracy-button-teleop" data-value="25">25%</button>
					<button type="button" class="accuracy-button-teleop" data-value="50">50%</button>
					<button type="button" class="accuracy-button-teleop" data-value="75">75%</button>
					<button type="button" class="accuracy-button-teleop" data-value="95">95%</button>
					<button type="button" class="accuracy-button-teleop" data-value="100">100%</button>
				</div>
				
				<h4 class="sub-label estimate-size-label">Estimated Size</h4>
				<div class="form-field estimate-size-field">
					<select id="estimate-size" name="estimateSize">
						<option value="">Select Range</option>
						<option value="1-10">1-10</option>
						<option value="11-25">11-25</option>
						<option value="26+">26+</option>
					</select>
					<label for="estimate-size">Estimate Size</label>
				</div>
			<div class="cycle-button-area">
				<button type="button" class="cycle-button" id="cycle-button">
					CYCLE
				</button>
				<div class="cycle-count" id="cycle-count">Cycles: 0</div>
			</div>
				<h3 class="objective-label">Climb</h3>
				<div class="toggle-button-group">
					<button type="button" class="toggle-button-teleop selected" data-value="no">
						No
					</button>
					<button type="button" class="toggle-button-teleop" data-value="yes">
						Yes
					</button>
				</div>

				<div class="action-area">
					<button type="button" class="back-button" onclick="window.location.href='/'">
						Back
					</button>
					<button type="submit" class="submit-button">
						Submit
					</button>
				</div>
			</div>
		</form>
	</main>
</body>
</html>

<style lang="scss">
@use '../styles/data-collection.scss';
</style>

<style is:global>
/* Toast Notifications */
.error-notification,
.success-notification {
	position: fixed;
	top: 20px;
	left: 50%;
	transform: translateX(-50%) translateY(0);
	padding: 16px 24px;
	border-radius: 8px;
	color: white;
	font-size: 15px;
	font-weight: 500;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
	z-index: 9999;
	max-width: 90%;
	text-align: center;
	opacity: 1;
	animation: slideIn 0.3s ease-out forwards;
}

.error-notification.fade-out,
.success-notification.fade-out {
	animation: slideOut 0.3s ease-out forwards;
}

.error-notification {
	background-color: #f44336;
}

.success-notification {
	background-color: #4caf50;
}

@keyframes slideIn {
	from {
		transform: translateX(-50%) translateY(-80px);
		opacity: 0;
	}
	to {
		transform: translateX(-50%) translateY(0);
		opacity: 1;
	}
}

@keyframes slideOut {
	from {
		transform: translateX(-50%) translateY(0);
		opacity: 1;
	}
	to {
		transform: translateX(-50%) translateY(-80px);
		opacity: 0;
	}
}
</style>

<script>
	import { initializeDataCollection } from '../scripts/data-collection';
	
	window.addEventListener('DOMContentLoaded', () => {
		initializeDataCollection();
	});
</script>